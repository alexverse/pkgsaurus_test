"use strict";(self.webpackChunkdocusaurus_website=self.webpackChunkdocusaurus_website||[]).push([[1988],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=i.createContext({}),l=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=l(e.components);return i.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),d=l(n),h=a,g=d["".concat(s,".").concat(h)]||d[h]||u[h]||r;return n?i.createElement(g,o(o({ref:t},c),{},{components:n})):i.createElement(g,o({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=d;var p={};for(var s in t)hasOwnProperty.call(t,s)&&(p[s]=t[s]);p.originalType=e,p.mdxType="string"==typeof e?e:a,o[1]=p;for(var l=2;l<r;l++)o[l]=n[l];return i.createElement.apply(null,o)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},7426:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>p,toc:()=>l});var i=n(7462),a=(n(7294),n(3905));const r={sidebar_position:1,title:"Migrate to Rhino"},o=void 0,p={unversionedId:"how-to/migrate-app-to-rhino",id:"how-to/migrate-app-to-rhino",title:"Migrate to Rhino",description:"--\x3e",source:"@site/docs/how-to/migrate-app-to-rhino.md",sourceDirName:"how-to",slug:"/how-to/migrate-app-to-rhino",permalink:"/pkgsaurus_test/docs/how-to/migrate-app-to-rhino",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Migrate to Rhino"},sidebar:"tutorialSidebar",previous:{title:"Guides",permalink:"/pkgsaurus_test/docs/category/guides"},next:{title:"Static Files",permalink:"/pkgsaurus_test/docs/how-to/use-static-files"}},s={},l=[{value:"Prepare Your Application for <code>rhino::init()</code>",id:"prepare-your-application-for-rhinoinit",level:2},{value:"<em>What if:</em> My App Uses renv",id:"what-if-my-app-uses-renv",level:3},{value:"Initialize Your Rhino Application",id:"initialize-your-rhino-application",level:2},{value:"<em>What if:</em> My App Had .Rprofile",id:"what-if-my-app-had-rprofile",level:3},{value:"Configure Your Rhino Application",id:"configure-your-rhino-application",level:2},{value:"Next Steps",id:"next-steps",level:2},{value:"Migrating JavaScript Code",id:"migrating-javascript-code",level:3},{value:"Migrating CSS styles to SASS",id:"migrating-css-styles-to-sass",level:3},{value:"Boxifying Application",id:"boxifying-application",level:3},{value:"Additional notes",id:"additional-notes",level:2}],c={toc:l};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,i.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"This guide aims to make your application up and running using Rhino as\nquickly as possible. Lets assume an application has a following\nstructure:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},".\n\u251c\u2500\u2500 utils\n\u2502   \u251c\u2500\u2500 foo.R\n\u2502   \u2514\u2500\u2500 bar.R\n\u251c\u2500\u2500 www\n\u2502   \u251c\u2500\u2500 main.css\n\u2502   \u2514\u2500\u2500 main.js\n\u251c\u2500\u2500 server.R\n\u2514\u2500\u2500 ui.R\n")),(0,a.kt)("p",null,"The migration process should not be affected by the combination of\nserver.R, ui.R, global.R, and app.R files in your application, or lack\nof thereof."),(0,a.kt)("h2",{id:"prepare-your-application-for-rhinoinit"},"Prepare Your Application for ",(0,a.kt)("inlineCode",{parentName:"h2"},"rhino::init()")),(0,a.kt)("p",null,"The first step is moving all application source files to a new ",(0,a.kt)("inlineCode",{parentName:"p"},"app"),"\ndirectory:"),(0,a.kt)("pre",null,(0,a.kt)("code",null,". \u2514\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"app"),"\u251c\u2500\u2500 utils \u2502   \u251c\u2500\u2500 bar.R \u2502   \u2514\u2500\u2500 foo.R \u251c\u2500\u2500 www \u2502   \u251c\u2500\u2500 main.css \u2502   \u2514\u2500\u2500 main.js \u251c\u2500\u2500 server.R \u2514\u2500\u2500 ui.R")),(0,a.kt)("p",null,"Once source files are moved, if you have a list of ",(0,a.kt)("inlineCode",{parentName:"p"},"library()")," calls put\nit in ",(0,a.kt)("inlineCode",{parentName:"p"},"dependencies.R")," in the root directory. If you do not have such\nlist, then Rhino will try to create one for you in ",(0,a.kt)("a",{parentName:"p",href:"#initialize-your-rhino-application"},"initialization\nstep"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",null,". \u251c\u2500\u2500 app \u2502   \u251c\u2500\u2500 utils \u2502   \u2502   \u251c\u2500\u2500 bar.R \u2502   \u2502   \u2514\u2500\u2500 foo.R \u2502   \u251c\u2500\u2500 www \u2502   \u2502   \u251c\u2500\u2500 main.css \u2502   \u2502   \u2514\u2500\u2500 main.js \u2502   \u251c\u2500\u2500 server.R \u2502   \u2514\u2500\u2500 ui.R \u2514\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"dependencies.R"))),(0,a.kt)("p",null,"After doing so, you should be able to run your application using\n",(0,a.kt)("inlineCode",{parentName:"p"},'shiny::shinyAppDir("app")'),"."),(0,a.kt)("h3",{id:"what-if-my-app-uses-renv"},(0,a.kt)("em",{parentName:"h3"},"What if:")," My App Uses renv"),(0,a.kt)("p",null,"If you have used renv in your application, then chances are your active\nrenv session does not have Rhino installed. To address this either\ndeactivate renv or run ",(0,a.kt)("inlineCode",{parentName:"p"},'renv::install("rhino")'),"."),(0,a.kt)("p",null,"Apart from additional files related to renv, the target file structure\nis no different than the one presented above."),(0,a.kt)("h2",{id:"initialize-your-rhino-application"},"Initialize Your Rhino Application"),(0,a.kt)("p",null,"Having your application prepared, you can now run ",(0,a.kt)("inlineCode",{parentName:"p"},"rhino::init()"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",null,". \u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},".github"),"\u2502   \u2514\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"workflows"),"\u2502       \u2514\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"rhino-test.yml"),"\u251c\u2500\u2500 app \u2502   \u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"js"),"\u2502   \u2502   \u2514\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"index.js"),"\u2502   \u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"logic"),"\u2502   \u2502   \u2514\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"__init__.R"),"\u2502   \u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"static"),"\u2502   \u2502   \u2514\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"favicon.ico"),"\u2502   \u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"styles"),"\u2502   \u2502   \u2514\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"main.scss"),"\u2502   \u251c\u2500\u2500 utils \u2502   \u2502   \u251c\u2500\u2500 bar.R \u2502   \u2502   \u2514\u2500\u2500 foo.R \u2502   \u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"view"),"\u2502   \u2502   \u2514\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"__init__.R"),"\u2502   \u251c\u2500\u2500 www \u2502   \u2502   \u251c\u2500\u2500 main.css \u2502   \u2502   \u2514\u2500\u2500 main.js \u2502   \u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"main.R"),"\u2502   \u251c\u2500\u2500 server.R \u2502   \u2514\u2500\u2500 ui.R \u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"renv"),"\u2502   \u2514\u2500\u2500 ... \u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"tests"),"\u2502   \u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"cypress"),"\u2502   \u2502   \u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"integration"),"\u2502   \u2502   \u2514\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},".gitignore"),"\u2502   \u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"testthat"),"\u2502   \u2502   \u2514\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"test-main.R"),"\u2502   \u2514\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"cypress.json"),"\u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},".Rprofile"),"\u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},".lintr"),"\u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},".renvignore"),"\u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"app.R"),"\u251c\u2500\u2500 dependencies.R \u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"old.Rprofile"),"\u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"renv.lock"),"\u251c\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"rhino.yml"),"\u2514\u2500\u2500 ",(0,a.kt)("span",{class:"tree-change"},"app.Rproj"))),(0,a.kt)("p",null,"If you did not use renv before, then Rhino initialized it for you.\nHowever, if you did use renv, then Rhino added necessary dependencies to\n",(0,a.kt)("inlineCode",{parentName:"p"},"renv.lock")," file."),(0,a.kt)("h3",{id:"what-if-my-app-had-rprofile"},(0,a.kt)("em",{parentName:"h3"},"What if:")," My App Had .Rprofile"),(0,a.kt)("p",null,"Your ",(0,a.kt)("inlineCode",{parentName:"p"},".Rprofile")," has been moved to ",(0,a.kt)("inlineCode",{parentName:"p"},"old.Rprofile"),". If it contained any\nrelevant bits (e.g.\xa0setting options), then carry it over to ",(0,a.kt)("inlineCode",{parentName:"p"},".Rprofile"),"\ncreated by Rhino."),(0,a.kt)("h2",{id:"configure-your-rhino-application"},"Configure Your Rhino Application"),(0,a.kt)("p",null,"The last step to get started with Rhino is configuring it. A minimal\nsetup that allows running the application is setting ",(0,a.kt)("inlineCode",{parentName:"p"},"legacy_entrypoint"),"\nin ",(0,a.kt)("inlineCode",{parentName:"p"},"rhino.yml"),". To be able to run application immediately set\n",(0,a.kt)("inlineCode",{parentName:"p"},"legacy_entrypoint: app_dir"),", as this approach requires no further\nadjustments to application\u2019s structure."),(0,a.kt)("p",null,"As you adjust adjust your application to fit best practices suggested by\nRhino, you can modify ",(0,a.kt)("inlineCode",{parentName:"p"},"legacy_entrypoint"),". Ultimately, when application\nis fully migrated to Rhino, ",(0,a.kt)("inlineCode",{parentName:"p"},"legacy_entrypoint")," setting can be removed\nfrom ",(0,a.kt)("inlineCode",{parentName:"p"},"rhino.yml"),". Refer to ",(0,a.kt)("a",{parentName:"p",href:"#next-steps"},"Next Steps")," section to see how\nto continue improving your application!"),(0,a.kt)("h2",{id:"next-steps"},"Next Steps"),(0,a.kt)("h3",{id:"migrating-javascript-code"},"Migrating JavaScript Code"),(0,a.kt)("p",null,"TODO: something along the lines of ",(0,a.kt)("inlineCode",{parentName:"p"},"build_js()")," details"),(0,a.kt)("h3",{id:"migrating-css-styles-to-sass"},"Migrating CSS styles to SASS"),(0,a.kt)("p",null,"TODO"),(0,a.kt)("h3",{id:"boxifying-application"},"Boxifying Application"),(0,a.kt)("p",null,"TODO: adjusting application to fit structure proposed by Rhino"),(0,a.kt)("h2",{id:"additional-notes"},"Additional notes"),(0,a.kt)("p",null,"The process described in ",(0,a.kt)("inlineCode",{parentName:"p"},"rhino::init()")," documentation, albeit not in\ngreat detail. The first step is to put all app files in the ",(0,a.kt)("inlineCode",{parentName:"p"},"app"),"\ndirectory, so it can be run with ",(0,a.kt)("inlineCode",{parentName:"p"},'shinyAppDir("app")'),". Practical\nexperience of migrating apps shows that it\u2019s a useful step which quickly\nlets you verify whether the app still works."),(0,a.kt)("p",null,"The process can be a bit unintuitive however. For example, if you\nalready have an ",(0,a.kt)("inlineCode",{parentName:"p"},"app.R")," file and ui/server/global in ",(0,a.kt)("inlineCode",{parentName:"p"},"R")," subdirectory,\nyou should still move the whole structure under ",(0,a.kt)("inlineCode",{parentName:"p"},"app"),". In this case\nyou\u2019ll end up with ",(0,a.kt)("inlineCode",{parentName:"p"},"app.R"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"app/app.R")," and ui/server/global in\n",(0,a.kt)("inlineCode",{parentName:"p"},"app/R/"),". Having two ",(0,a.kt)("inlineCode",{parentName:"p"},"app.R")," files might feel awkward."),(0,a.kt)("p",null,"In general you use ",(0,a.kt)("inlineCode",{parentName:"p"},"rhino::init()")," for migration. This cannot be done\nvia RStudio GUI."),(0,a.kt)("p",null,"If you already have ",(0,a.kt)("inlineCode",{parentName:"p"},".Rprofile")," with renv when migrating, you\u2019ll load it\nand won\u2019t have Rhino inside. You need to run ",(0,a.kt)("inlineCode",{parentName:"p"},"rhino::init()")," from a\ndifferent directory (or perhaps run renv::deactivate())."),(0,a.kt)("p",null,"Rhino will renv::load() your renv.lock. In particular it will set your\n",(0,a.kt)("inlineCode",{parentName:"p"},'options("repos"'),") based on ",(0,a.kt)("inlineCode",{parentName:"p"},"renv.lock"),"."),(0,a.kt)("p",null,"What to do when I get \u201cunsatisfied dependencies\u201d during migration?"))}u.isMDXComponent=!0}}]);